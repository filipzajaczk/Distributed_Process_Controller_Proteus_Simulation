C51 COMPILER V9.60.7.0   BCD                                                               01/29/2026 16:19:38 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE BCD
OBJECT MODULE PLACED IN .\Objects\bcd.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE bcd.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\bcd.l
                    -st) TABS(2) OBJECT(.\Objects\bcd.obj)

line level    source

   1          #include <REGX51.H>
   2          
   3          unsigned char code kody[] = {0x3F, 0x06, 0x5B, 0x4F, 0x66, 0x6D, 0x7D, 0x07, 0x7F, 0x6F};
   4          unsigned char xdata lewy_disp  _at_ 0xFE00;
   5          unsigned char xdata prawy_disp _at_ 0xFD00;
   6          volatile unsigned char j = 0;
   7          volatile unsigned char i = 0;
   8          
   9          
  10          volatile bit odebrano_nowy_pakiet = 0;
  11          volatile unsigned char odebrana_komenda = 0;
  12          volatile unsigned char odebrana_dana = 0;
  13          
  14          //adresy urzadzen
  15          #define KLAWIATURA  0xF0
  16          #define LCD     0xE0
  17          #define BCD     0xD0
  18          #define SILNIK  0xB0
  19          
  20          //komendy
  21          #define OBROTY  0x01
  22          #define MOC  0x02
  23          #define KIERUNEK      0x03
  24          #define GRZANIE_L1    0x04
  25          #define GRZANIE_L2    0x05
  26          #define START         0x06
  27          #define MENU          0x07
  28          #define POKAZ_MENU    0x08
  29          
  30          
  31          void odebranie() interrupt 4
  32          {
  33   1        static unsigned char czekam = 0;
  34   1        static unsigned char temp = 0;
  35   1        unsigned char bajt;
  36   1        
  37   1        if(RI)
  38   1        {
  39   2          bajt = SBUF;
  40   2          RI = 0;
  41   2          
  42   2          if (czekam == 0) 
  43   2          {
  44   3            if ((bajt & 0xF0) == BCD)
  45   3            {
  46   4              temp = bajt & 0x0F;
  47   4              czekam = 1;
  48   4            }
  49   3          }
  50   2      
  51   2          else
  52   2          {
  53   3            odebrana_komenda = temp;
  54   3            odebrana_dana = bajt;
C51 COMPILER V9.60.7.0   BCD                                                               01/29/2026 16:19:38 PAGE 2   

  55   3            odebrano_nowy_pakiet = 1;
  56   3            czekam = 0;
  57   3          }
  58   2        }
  59   1          
  60   1      }
  61          
  62          void wyswietl_bcd() interrupt 1
  63          {
  64   1          TH0 = 0xFF;
  65   1          TL0 = 0x8D;
  66   1          lewy_disp  = kody[(odebrana_dana / 10) % 10];
  67   1          prawy_disp = kody[odebrana_dana % 10];
  68   1      }
  69          
  70          void init
  71            (void)
  72          {
  73   1        TMOD = 0x21; 
  74   1        TH1 = 0xFD;
  75   1        TL1 = 0xFD;
  76   1        SCON = 0x50;
  77   1        TR1 = 1;
  78   1        TH0 = 0xFF;
  79   1        TL0 = 0x8D;
  80   1        ET0 = 1;
  81   1        TR0 = 1;
  82   1        ES = 1; 
  83   1        EA = 1; 
  84   1      }
  85          
  86          
  87          void main(void){
  88   1        
  89   1        P3_4 = 0;
  90   1        P1 = 0x00;
  91   1        init();
  92   1      
  93   1        lewy_disp  = 0x00;
  94   1        prawy_disp = 0x00;
  95   1      
  96   1        while (1)
  97   1        {
  98   2          if (odebrano_nowy_pakiet)
  99   2          {
 100   3            odebrano_nowy_pakiet = 0;
 101   3          }
 102   2        }
 103   1        
 104   1      }
 105            


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    173    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.60.7.0   BCD                                                               01/29/2026 16:19:38 PAGE 3   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
